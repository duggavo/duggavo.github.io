let setTab;(()=>{let t={};function n(e){return new Promise(n=>{fetch("translations/"+e+".json").then(t=>t.json()).then(e=>{t=e,n()})})}!async function(){l=navigator.languages[0]||navigator.language||navigator.userLanguage,"it-IT"===l||"it-CH"===l||"it"===l?await n("it"):await n("en"),function(){const n=1.5,o=.002;document.getElementById("buy").innerText=t.buy,document.getElementById("sell").innerText=t.sell;const l=document.getElementById("myChart");let s=new Chart(l,{type:"line",data:{labels:[],datasets:[{label:t.price+" ($)",data:[],borderWidth:1}]},options:{elements:{point:{hitRadius:30,radius:0},line:{stepped:!1}}}});l.style.display="none";let a=["btc","xmr","ltc","eth","wow","bnb","sim"],c={btc:"bitcoin",xmr:"monero",ltc:"litecoin",eth:"ethereum",wow:"wownero",bnb:"binancecoin",sim:"simulatedVolatility"};function r(t){window.localStorage.setItem("bals",JSON.stringify(t))}function d(){const t=window.localStorage.getItem("bals");if("string"==typeof t)return JSON.parse(t);{let t={usd:1e3};for(i of a)t[i]=0;return t}}let u={};function m(){let t=[];for(i in c)t.push(c[i]);console.log("n:",t.join(",")),fetch("https://api.coingecko.com/api/v3/simple/price?ids="+t.join(",")+"&vs_currencies=usd").then(t=>t.json()).then(t=>{(u=t).simulatedVolatility={usd:u.bitcoin.usd**n*o},g()})}function p(t){return console.log(t),console.log(c),u[c[t]].usd}function g(){let e=d();const n=document.getElementById("coins");n.innerHTML=`\n<tr>\n\t<th>${t.coin}</th>\n\t<th>${t.bal}</th>\n\t<th>${t.bal} ($)</th>\n</tr>\n`;let o=0;for(i in e){const t=e[i];let l="<tr ",s=t;"usd"!=i&&(l+=`id=coin_${i} onclick=setTab("${i}") `,s*=p(i)),o+=s,n.innerHTML+=l+`class=coin><td>${i}</td><td>${t.toPrecision(4)}</td><td>${s.toPrecision(4)}</td></tr>`}document.getElementById("bal").innerText=o.toFixed(2)}function h(e){let n=prompt(t.how_much_buy);(n=parseFloat(n))&&(function(e,n){const o=p(e);b=d(),n>b.usd?alert(t.not_enough_funds):!n||n<0?alert(t.place_bigger):(b[e]+=n/o,b.usd-=n,r(b))}(e,n),g())}function y(e){let n=prompt(t.how_much_sell.replace("%x",e.toUpperCase()));0===(n=parseFloat(n))&&(n=d()[e],console.log("amount is "+n)),n&&(function(e,n){const o=p(e);b=d(),b[e]<n?alert(t.not_enough_funds):!n||n<0?alert(t.place_bigger):(b[e]-=n,b.usd+=n*o,r(b))}(e,n),g())}m(),setInterval(m,3e4);let f="";setTab=((t,i=!1)=>{i||(document.getElementById("myChart").style.display="none",document.getElementById("coinInfo").style.display="none"),document.getElementById("coinName").innerText=`${function(t){return t.charAt(0).toUpperCase()+t.slice(1)}(c[t])} (${t.toUpperCase()})`,document.getElementById("buy").onclick=(()=>{h(t)}),document.getElementById("sell").onclick=(()=>{y(t)}),f=t,function(t){let i=document.getElementById("time").value,a=1,r=1;"sim"===t&&(t="btc",a=n,r=o),fetch("https://api.coingecko.com/api/v3/coins/"+c[t]+"/market_chart?vs_currency=usd&days="+i).then(t=>t.json()).then(t=>{let n=[],o=[];for(e of t.prices)n.push(""),o.push(e[1]**a*r);s.data.labels=n,s.data.datasets[0].data=o,s.update("none"),l.style.display="block",document.getElementById("coinInfo").style.display="block"})}(t)}),document.getElementById("time").onchange=(()=>{setTab(f,!0)}),setInterval(()=>{""==f||document.hidden||setTab(f,!0)},6e4)}()}()})();